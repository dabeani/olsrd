<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Web Status</title>
  <!-- Bootstrap CSS (local, minimal) -->
  <link rel="stylesheet" href="css/bootstrap.min.css">
  <!-- Chart.js for modern graphs (local, UMD version) -->
  <script src="js/chart.min.js"></script>
  <!-- Custom tweaks -->
  <link rel="stylesheet" href="css/custom.css">
    <style>
  body { padding: 20px; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; }
  .tab-pane { display: none; }
  .tab-pane.active { display: block; }
  pre { background:#f8f8f8; padding:10px; border:1px solid #ddd; }
  .small-muted { font-size:90%; color:#666; }
  .dl-horizontal dt { width:200px; }
  .page-header h1 { margin-bottom:6px; }
  .table-condensed th, .table-condensed td { padding:6px; }
  .table-hover > tbody > tr:hover { background-color:#f5f5f5; }
  /* Spinner removed: replaced by footer request/response indicators */
  /* Fetch stats badges */
  .fetch-badge { display:inline-block; padding:5px 10px; margin-right:6px; border-radius:6px; background:#f0f6ff; color:#013369; font-size:90%; border:1px solid #c9deff; }
  .fetch-badge.warn { background:#fff6e5; color:#6a4a00; border-color:#ffe9b8; }
  .fetch-badge.crit { background:#ffecec; color:#6a0000; border-color:#ffb8b8; }
  /* Nav host styling */
  #nav-host { font-weight:600; }
  #nav-host .glyphicon { vertical-align:middle; margin-right:6px; }
  #nav-host #hostname { color: #013369; margin-left:4px; }
  /* Responsive: hide hostname text on narrow viewports to avoid wrapping */
  @media (max-width: 600px) {
    #nav-host #hostname { display:none; }
    #nav-host { padding-right:6px; }
  }
  /* blink animation for critical indicator */
  @keyframes fetchPulse { 0% { box-shadow: 0 0 0 rgba(185,74,72,0.0); } 50% { box-shadow: 0 0 12px rgba(185,74,72,0.55); } 100% { box-shadow: 0 0 0 rgba(185,74,72,0.0); } }
  .fetch-crit-blink { animation: fetchPulse 1.2s ease-in-out infinite; }

  /* small circular dot indicator in the footer */
  .footer-dot { display:inline-block; border-radius:50%; width:12px; height:12px; background:#cfcfcf; transition: box-shadow 0.15s ease, background-color 0.15s ease, transform 0.12s ease; }
  .footer-dot-on { background: #2ecc71; box-shadow: 0 0 6px rgba(46,204,113,0.6); transform: scale(1.05); }
  .footer-dot-off { background: #cfcfcf; box-shadow: none; }
  .footer-diag-summary { font-size:12px; color:#444; }

  /* Enhanced Versions Tab Styling */
  .versions-container .panel { margin-bottom: 8px; box-shadow: 0 1px 2px rgba(0,0,0,0.06); }
  .versions-container .panel-primary .panel-heading { background: linear-gradient(135deg, #007bff, #0056b3); border: none; }
  .versions-container .panel-info .panel-heading { background: linear-gradient(135deg, #17a2b8, #138496); border: none; color: white; }
  .versions-container .info-item { margin-bottom: 6px; padding: 8px; border-radius: 6px; background: #f8f9fa; border-left: 4px solid #007bff; transition: all 0.15s ease; }
  .versions-container .info-item:hover { background: #f1f3f5; transform: translateX(1px); }
  .versions-container .info-label { font-weight: 600; color: #495057; margin-bottom: 2px; }
  .versions-container .info-label .glyphicon { margin-right: 6px; }
  .versions-container .info-value { color: #6c757d; word-break: break-word; font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace; font-size: 12px; }
  .versions-container .status-badge { display: inline-block; font-size: 11px; margin-right: 6px; margin-bottom: 4px; padding: 4px 8px; border-radius: 16px; font-weight: 500; }
  .versions-container .status-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
  .versions-container .status-danger { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
  .versions-container .status-info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
  .versions-container .json-data { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; padding: 15px; font-size: 12px; line-height: 1.4; }
  .versions-container .panel-collapse { border-top: 1px solid #dee2e6; }
  .versions-container .panel-title a { color: #333; text-decoration: none; }
  .versions-container .panel-title a:hover { color: #007bff; }
  .versions-container .panel-title .glyphicon { margin-right: 8px; transition: transform 0.2s ease; }
  .versions-container .panel-title a.collapsed .glyphicon { transform: rotate(-90deg); }

  /* Modern Statistics Dashboard */
  .stats-container { margin-top: 20px; }
  .stats-row { display: flex; gap: 20px; margin-bottom: 20px; flex-wrap: wrap; }
  .stats-card { 
    flex: 1; 
    min-width: 300px; 
    background: white; 
    border: 1px solid #e0e0e0; 
    border-radius: 8px; 
    box-shadow: 0 2px 4px rgba(0,0,0,0.1); 
    overflow: hidden;
  }
  .stats-card.full-width { flex: 1 1 100%; min-width: 600px; }
  .stats-header { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    padding: 15px 20px; 
    background: #f8f9fa; 
    border-bottom: 1px solid #e0e0e0; 
  }
  .stats-header h4 { margin: 0; color: #333; font-size: 16px; font-weight: 600; }
  .stats-controls { display: flex; gap: 8px; }
  .stats-chart-container { 
    padding: 20px; 
    position: relative; 
    height: 250px;
  }
  .stats-info { 
    padding: 15px 20px; 
    background: #f8f9fa; 
    border-top: 1px solid #e0e0e0; 
  }
  .stats-metrics { display: flex; gap: 20px; flex-wrap: wrap; }
  .metric { display: flex; align-items: center; gap: 8px; }
  .metric-label { font-size: 13px; color: #666; font-weight: 500; }
  .metric-value { font-size: 14px; color: #333; font-weight: 600; }
  .metric-trend { font-size: 12px; padding: 2px 6px; border-radius: 12px; }
  .metric-trend.trend-up { background: #d4edda; color: #155724; }
  .metric-trend.trend-down { background: #f8d7da; color: #721c24; }
  .metric-trend.trend-flat { background: #e2e3e5; color: #383d41; }

  /* Responsive design */
  @media (max-width: 768px) {
    .stats-row { flex-direction: column; gap: 15px; }
    .stats-card { min-width: auto; }
    .stats-header { padding: 12px 15px; }
    .stats-chart-container { padding: 15px; height: 200px; }
    .stats-info { padding: 12px 15px; }
    .stats-metrics { flex-direction: column; gap: 8px; }
    .metric { justify-content: space-between; }
  }

  @media (max-width: 480px) {
    .stats-container { margin-top: 10px; }
    .stats-header h4 { font-size: 14px; }
    .stats-chart-container { height: 180px; }
  }
    </style>
    </style>
  </head>
  <body>
    <div class="container layout-root">
      <header class="site-header">
        <!-- Global header populated by status/diagnostics info -->
        <div id="global-versions-header"></div>
      </header>

      <div class="row">
        <aside class="col-sm-3 sidebar">
          <ul id="mainTabs" class="nav nav-pills nav-stacked">
            <li role="presentation"><a href="#tab-main"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span> Übersicht</a></li>
            <li role="presentation" class="active"><a href="#tab-status"><span class="glyphicon glyphicon-dashboard" aria-hidden="true"></span> Status</a></li>
            <li role="presentation"><a href="#tab-olsr"><span class="glyphicon glyphicon-random" aria-hidden="true"></span> OLSR Links</a></li>
            <li role="presentation"><a href="#tab-stats"><span class="glyphicon glyphicon-signal" aria-hidden="true"></span> Statistics</a></li>
            <li role="presentation"><a href="#tab-connections"><span class="glyphicon glyphicon-transfer" aria-hidden="true"></span> Connections</a></li>
            <li role="presentation"><a href="#tab-traceroute"><span class="glyphicon glyphicon-road" aria-hidden="true"></span> Traceroute</a></li>
            <li role="presentation"><a href="#tab-log"><span class="glyphicon glyphicon-list" aria-hidden="true"></span> Log</a></li>
            <li role="presentation"><a href="#tab-contact"><span class="glyphicon glyphicon-user" aria-hidden="true"></span> Kontakt</a></li>
            <li role="presentation" id="tab-admin-link" class="d-none"><a href="#tab-admin"><span class="glyphicon glyphicon-lock" aria-hidden="true"></span> Admin</a></li>
          </ul>
        </aside>

        <main class="col-sm-9 content">
          <div class="tab-content">
        <!-- Status -->
        <div id="tab-status" class="tab-pane active">
          <div id="status-card" class="panel panel-default status-card">
            <div class="header-row">
              <div>
                <div class="bold-title"><span id="status-hostname">-</span></div>
                <div class="small-muted" id="status-host-ip">-</div>
              </div>
              <div class="right-column">
                <div>Uptime: <span id="status-uptime">-</span></div>
                <div>Links: <span id="olsr-links-count">-</span></div>
              </div>
            </div>
            <div id="links-live-controls">
              <label class="inline-label"><input type="checkbox" id="links-live-enable"> Live links</label>
              <label class="inline-label">Interval:<input id="links-live-interval" type="number" min="1" value="10" class="input-interval">s</label>
            </div>
          </div>
          <!-- Styled info block (match Versions tab style) -->
          <div class="versions-container">
            <div class="info-item-compact">
              <div class="flex-1">
                <div class="info-label"><span class="glyphicon glyphicon-time" aria-hidden="true"></span> System Uptime</div>
                <div class="info-value"><span id="dl-uptime">-</span></div>
              </div>
              <div class="info-right">
                <div class="info-label"><span class="glyphicon glyphicon-time" aria-hidden="true"></span> Last Updated</div>
                <div class="info-value"><span id="last-updated">-</span></div>
              </div>
            </div>

            <div class="info-item-compact">
              <div class="flex-1">
                <div class="info-label"><span class="glyphicon glyphicon-transfer" aria-hidden="true"></span> IPv4 Default-Route</div>
                <div class="info-value"><span id="dl-default-route"><span id="default-route">n/a</span></span></div>
              </div>
              <div class="info-right">
                <div class="info-label"><span class="glyphicon glyphicon-signal" aria-hidden="true"></span> Versions</div>
                <div class="info-value"><span id="status-versions-string">&nbsp;</span></div>
              </div>
            </div>
          </div>
          <div class="table-search-container"><input class="table-search-input form-control input-sm" data-target="#devicesTable" placeholder="Search..."></div>
          <div class="table-responsive">
            <table id="devicesTable" class="table table-hover table-bordered table-condensed">
              <thead>
                <tr>
                  <th data-key="ipv4">Local (IP / HW)</th>
                  <th data-key="hostname">Hostname</th>
                  <th data-key="product">Product</th>
                  <th data-key="uptime">Uptime</th>
                  <th data-key="mode">Mode</th>
                  <th data-key="essid">ESSID</th>
                  <th data-key="firmware">Firmware</th>
                  <th data-key="signal">Signal</th>
                  <th data-key="tx_rate">Tx Rate</th>
                  <th data-key="rx_rate">Rx Rate</th>
                  <th data-key="wireless">Wireless</th>
                  <th data-key="source">Source</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- Diagnostics modal (opened from footer diagnostics button) -->
        <div id="diagnostics-modal" class="modal modal-overlay" aria-hidden="true">
          <div class="modal-panel modal-panel-sm modal-body-scroll" role="dialog" aria-modal="true">
            <div class="flex-between">
              <h4 class="modal-title">Diagnostics</h4>
              <button id="diag-close" class="btn btn-default btn-sm">Close</button>
            </div>
            <div class="flex-gap-8">
              <button class="btn btn-default btn-sm diag-nav" data-page="params">Parameters</button>
              <button class="btn btn-default btn-sm diag-nav" data-page="intervals">Intervals</button>
              <button class="btn btn-default btn-sm diag-nav" data-page="logging">Logging</button>
            </div>
            <div id="diag-content" class="diag-content modal-pre"></div>
          </div>
        </div>

        <!-- Statistics -->
        <div id="tab-stats" class="tab-pane">
          <h3>Statistics</h3>
          <div class="stats-container">
            <div class="stats-row">
              <div class="stats-card">
                <div class="stats-header">
                  <h4>Network Nodes & Routes</h4>
                  <div class="stats-controls">
                    <button id="stats-refresh" class="btn btn-xs btn-default">Refresh</button>
                  </div>
                </div>
                <div class="stats-chart-container">
                  <canvas id="network-chart" width="400" height="200"></canvas>
                </div>
                <div class="stats-info">
                  <div class="stats-metrics">
                    <div class="metric">
                      <span class="metric-label">Nodes4:</span>
                      <span class="metric-value" id="nodes4-cur">-</span>
                      <span class="metric-trend" id="nodes4-trend">-</span>
                    </div>
                    <div class="metric">
                      <span class="metric-label">Routes4:</span>
                      <span class="metric-value" id="routes4-cur">-</span>
                      <span class="metric-trend" id="routes4-trend">-</span>
                    </div>
                    <div class="metric">
                      <span class="metric-label">Nodes6:</span>
                      <span class="metric-value" id="nodes6-cur">-</span>
                      <span class="metric-trend" id="nodes6-trend">-</span>
                    </div>
                    <div class="metric">
                      <span class="metric-label">Routes6:</span>
                      <span class="metric-value" id="routes6-cur">-</span>
                      <span class="metric-trend" id="routes6-trend">-</span>
                    </div>
                  </div>
                </div>
              </div>
              
              <div class="stats-card">
                <div class="stats-header">
                  <h4>System Resources</h4>
                </div>
                <div class="stats-chart-container">
                  <canvas id="system-chart" width="400" height="200"></canvas>
                </div>
                <div class="stats-info">
                  <div class="stats-metrics">
                    <div class="metric">
                      <span class="metric-label">CPU Load:</span>
                      <span class="metric-value" id="cpu-load">-</span>
                    </div>
                    <div class="metric">
                      <span class="metric-label">Memory:</span>
                      <span class="metric-value" id="memory-usage">-</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="stats-row">
              <div class="stats-card full-width">
                <div class="stats-header">
                  <h4>Fetch Operations</h4>
                </div>
                <div class="stats-chart-container">
                  <canvas id="fetch-chart" width="800" height="200"></canvas>
                </div>
                <div class="stats-info">
                  <div class="stats-metrics">
                    <div class="metric">
                      <span class="metric-label">Queue:</span>
                      <span class="metric-value" id="queue-length">-</span>
                    </div>
                    <div class="metric">
                      <span class="metric-label">Processing:</span>
                      <span class="metric-value" id="processing-count">-</span>
                    </div>
                    <div class="metric">
                      <span class="metric-label">Success Rate:</span>
                      <span class="metric-value" id="success-rate">-</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Main / Willkommen -->
        <div id="tab-main" class="tab-pane">
          <div class="page-header">
            <h1>Willkommen auf <span id="main-host-page"> </span></h1>
          </div>
          <div class="panel panel-default">
            <div class="panel-body"><b>WAS?</b></div>
            <div class="panel-footer">FunkFeuer ist ein freies, experimentelles Netzwerk in Wien, Graz, der Weststeiermark, in Teilen des Weinviertels (N&Ouml;) und in Bad Ischl. Es wird aufgebaut und betrieben von computerbegeisterten Menschen. Das Projekt verfolgt keine kommerziellen Interessen.</div>
          </div>
          <div class="panel panel-default">
            <div class="panel-body"><b>FREI?</b></div>
            <div class="panel-footer">FunkFeuer ist offen f&uuml;r jeden und jede, der/die Interesse hat und bereit ist mitzuarbeiten. Es soll dabei ein nicht reguliertes Netzwerk entstehen, welches das Potential hat, den digitalen Graben zwischen den sozialen Schichten zu &Uuml;berbr&uuml;cken und so Infrastruktur und Wissen zur Verf&uuml;gung zu stellen. Zur Teilnahme an FunkFeuer braucht man einen WLAN Router (gibt's ab 60 Euro) oder einen PC, das OLSR Programm, eine IP Adresse von FunkFeuer, etwas Geduld und Motivation. Auf unserer Karte ist eingezeichnet, wo man FunkFeuer schon &Uuml;berall (ungef&auml;r) empfangen kann (bitte beachte, dass manchmal H&auml;user oder &Auml;hnliches im Weg sind, dann geht's nur &uuml;ber Umwege).</div>
          </div>
        </div>

        <!-- Contact -->
        <div id="tab-contact" class="tab-pane">
          <h3>Kontakt</h3>
          <p>Kontaktinformationen...</p>
        </div>

        <!-- OLSR Links -->
  <div id="tab-olsr" class="tab-pane">
  <h3>OLSR Links <button id="refresh-links" class="btn btn-xs btn-default"><i class="glyphicon glyphicon-refresh"></i></button>
            <span id="links-status" class="small-muted"></span></h3>
          <div class="table-search-container"><input class="table-search-input form-control input-sm" data-target="#olsrLinksTable" placeholder="Search..."></div>
          <div class="table-responsive">
            <table id="olsrLinksTable" class="table table-condensed table-striped">
              <thead>
                <tr>
                  <th data-key="intf">Intf</th>
                  <th data-key="local">Local</th>
                  <th data-key="remote">Remote</th>
                  <th data-key="remote_host">Remote Host</th>
                  <th data-key="remote_node">Node</th>
                  <th data-key="lq">LQ</th>
                  <th data-key="nlq">NLQ</th>
                  <th data-key="cost">Cost</th>
                  <th data-key="etx">ETX</th>
                  <th data-key="routes">Routes</th>
                  <th data-key="nodes">Nodes</th>
                  <th data-key="actions">Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- Connections -->
        <div id="tab-connections" class="tab-pane">
          <h3>Connections <button id="refresh-connections" class="btn btn-xs btn-default"><i class="glyphicon glyphicon-refresh"></i></button>
            <span id="connections-status" class="small-muted"></span></h3>
          <div class="table-search-container"><input class="table-search-input form-control input-sm" data-target="#connectionsTable" placeholder="Search..."></div>
          <div class="table-responsive">
            <table id="connectionsTable" class="table table-condensed table-striped">
              <thead>
                <tr>
                  <th data-key="port">Port</th>
                  <th data-key="bridge">Bridge</th>
                  <th data-key="macs">MACs</th>
                  <th data-key="ips">IPs</th>
                  <th data-key="hostname">Hostname</th>
                  <th data-key="node">Node</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- Simple Modal for Route Details -->
        <div id="route-modal" class="modal-overlay" aria-hidden="true">
          <div class="modal-panel">
            <div class="modal-row">
              <div class="modal-row-left">
                <h4 id="route-modal-title" class="modal-title">Routes</h4>
                <span id="route-modal-count" class="label label-primary d-none"></span>
              </div>
              <div class="modal-row-right">
                <input id="route-filter" type="text" class="form-control input-sm input-wide-220" placeholder="Filter (prefix, dev, metric)">
                <button id="route-copy" type="button" class="btn btn-xs btn-default" title="Copy visible routes"><span class="glyphicon glyphicon-copy" aria-hidden="true"></span></button>
                <button id="route-modal-close" type="button" class="btn btn-xs btn-default">Close</button>
              </div>
            </div>
            <div class="modal-table-wrap">
              <table id="route-modal-table" class="table table-condensed table-striped">
                <thead>
                  <tr>
                    <th data-key="destination">Destination <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                    <th data-key="device">Device <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                    <th data-key="metric">Metric <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                    <th>Raw</th>
                  </tr>
                </thead>
                <tbody id="route-modal-tbody"><tr><td colspan="4" class="text-muted">Loading...</td></tr></tbody>
              </table>
            </div>
            <div class="modal-row-info">
              <div>Click a column header to sort (coming soon) • Filter supports simple substring match.</div>
              <div></div>
            </div>
            <pre id="route-modal-body" class="route-modal-body-pre"></pre>
          </div>
        </div>

          <!-- Simple Modal for Node Details -->
          <div id="node-modal" class="modal-overlay" aria-hidden="true">
            <div class="modal-panel">
              <div class="modal-row">
                <div class="modal-row-left">
                  <h4 id="node-modal-title" class="modal-title">Nodes</h4>
                  <span id="node-modal-count" class="label label-primary d-none"></span>
                </div>
                <div class="modal-row-right">
                  <input id="node-filter" type="text" class="form-control input-sm input-wide-220" placeholder="Filter (name, ip, device)">
                  <button id="node-copy" type="button" class="btn btn-xs btn-default" title="Copy visible nodes"><span class="glyphicon glyphicon-copy" aria-hidden="true"></span></button>
                  <button id="node-modal-close" type="button" class="btn btn-xs btn-default">Close</button>
                </div>
              </div>
              <div class="modal-table-wrap">
                <table id="node-modal-table" class="table table-condensed table-striped">
                  <thead>
                    <tr>
                      <th data-key="ip">IP / Net <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="n">Name <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="i">ID <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="d">Device <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="h">Host <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="m">Master <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="node-modal-tbody"><tr><td colspan="6" class="text-muted">Loading...</td></tr></tbody>
                </table>
              </div>
              <div class="modal-row-info">
                <div>Filter supports simple substring match.</div>
                <div></div>
              </div>
              <pre id="node-modal-body" class="route-modal-body-pre"></pre>
            </div>
          </div>
              <!-- Fetch debug modal -->
              <div id="fetch-debug-modal" class="modal-overlay" aria-hidden="true">
                <div class="modal-panel modal-panel-sm">
                  <div class="flex-between">
                    <h4 class="modal-title">Fetch Queue Debug</h4>
                    <div class="flex-gap-8"><button id="fetch-debug-close" class="btn btn-xs btn-default">Close</button></div>
                  </div>
                    <div class="modal-body-scroll">
                    <pre id="fetch-debug-body" class="modal-pre">Loading...</pre>
                  </div>
                </div>
              </div>

        <!-- Versions tab removed: content is available in Diagnostics -->

        <!-- Traceroute -->
        <div id="tab-traceroute" class="tab-pane">
          <h3>Traceroute</h3>
          <div class="form-inline form-inline-mb">
            <input id="tr-host" class="form-control input-sm tr-host-large" placeholder="host or ip">
            <button id="tr-run" class="btn btn-sm btn-primary">Run</button>
          </div>
          <pre id="p-traceroute" class="d-none">Traceroute output will appear here</pre>
          <div class="table-search-container"><input class="table-search-input form-control input-sm" data-target="#tracerouteTable" placeholder="Search..."></div>
          <div class="table-responsive mt-8">
            <table id="tracerouteTable" class="table table-condensed table-striped">
              <thead>
                <tr><th>#</th><th>IP</th><th>Hostname</th><th>Ping</th></tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <!-- Log -->
        <div id="tab-log" class="tab-pane">
          <h3>Log <button id="refresh-log" class="btn btn-xs btn-default"><i class="glyphicon glyphicon-refresh"></i></button>
            <span id="log-status" class="small-muted"></span></h3>
          <div class="table-search-container"><input id="log-filter" class="table-search-input form-control input-sm" placeholder="Filter log lines..."></div>
          <div class="mt-8">
            <pre id="log-pre" class="log-pre">Loading...</pre>
          </div>
        </div>

        <!-- Admin (link only) -->
        <div id="tab-admin" class="tab-pane">
          <h3>Admin</h3>
          <p><a id="adminLink" href="#" target="_blank">Login</a></p>
        </div>

          </div>
        </main>
      </div>
  <!-- Toast for critical fetch queue alerts -->
      <div id="fetch-toast">
        <div id="fetch-toast-body">
          <strong>Fetch queue critical</strong>
          <div id="fetch-toast-msg"></div>
        </div>
      </div>

      <!-- Footer diagnostics drawer (hidden until opened) -->
      <div id="footer-diagnostics-panel" class="footer-diagnostics" aria-hidden="true">
        <div class="footer-diagnostics-inner">
          <div class="footer-diagnostics-header">
            <div class="fw-700">Diagnostics</div>
            <div class="small-muted ml-12">Live diagnostics snapshot</div>
            <!-- prominent versions/timestamp (populated by app.js) -->
            <div id="diag-versions-string" class="diag-versions-badge">&nbsp;</div>
            <div class="flex-gap-8 ml-auto">
              <div class="small-muted">View:</div>
              <button id="diag-view-toggle" class="btn btn-xs btn-default">Compact</button>
              <button id="diag-flatten-btn" class="btn btn-xs btn-default">Flatten</button>
              <button id="footer-diagnostics-close" class="btn btn-xs btn-default">Close</button>
            </div>
          </div>
          <div id="footer-diagnostics-body" class="footer-diagnostics-body">
            <!-- content populated by JS -->
            <div class="small-muted small-muted-padding">Click open to load diagnostics.</div>
          </div>
        </div>
      </div>

      <!-- Minimal sticky footer with pending-request count and served-by on the left -->
      <footer id="status-footer" class="status-footer">
        <div class="footer-inner">
          <div class="footer-left">
              <span id="footer-served">Served by olsrd-status-plugin</span>
              <span class="footer-sep">|</span>
              <span id="footer-latency">RTT: -- ms</span>
            </div>
          <div id="footer-indicators" class="footer-right">
            <div class="footer-right-item">
              <svg class="footer-small-icon" width="14" height="14" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" title="Last updated"><path d="M8 3.5a.5.5 0 0 1 .5.5v3l2 1a.5.5 0 1 1-.5.866L8 7V4a.5.5 0 0 1 .5-.5zM8 2a6 6 0 1 0 0 12A6 6 0 0 0 8 2z"/></svg>
              <div id="footer-last-updated" class="footer-trunc">-</div>
            </div>
            <span class="footer-sep">|</span>
            <div class="footer-right-item">
              <svg class="footer-small-icon" width="14" height="14" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" title="Last request"><path d="M2 8a.5.5 0 0 1 .5-.5h8.793L9.146 5.354a.5.5 0 1 1 .708-.708l3 3a.498.498 0 0 1 .146.354.498.498 0 0 1-.146.354l-3 3a.5.5 0 0 1-.708-.708L11.293 8.5H2.5A.5.5 0 0 1 2 8z"/></svg>
              <div id="footer-last-request" class="footer-trunc">-</div>
            </div>
            <span class="footer-sep">|</span>
            <div class="footer-right-item">
              <div class="footer-diag-summary" id="footer-diag-summary">&nbsp;</div>
              <div id="footer-pending" title="No pending requests" class="footer-pending">0</div>
              <div id="footer-dot" class="footer-dot footer-dot-off" aria-hidden="true" title="idle"></div>
            </div>
            <!-- small handle to open diagnostics drawer -->
            <div id="footer-diagnostics-handle" title="Open diagnostics" class="diag-handle">Diagnostics</div>
          </div>
        </div>
      </footer>

      <!-- Small transient toast for actions (refresh success/error) -->
      <div id="action-toast">
        <div id="action-toast-body">Action</div>
      </div>

  <!-- legacy served-by footer removed (moved into sticky footer) -->
    </div>

    <!-- jQuery + Bootstrap JS (local) -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- App JS -->
    <script src="js/app.js"></script>
  </body>
</html>

<!-- Diagnostics modal for expanded card JSON -->
          <div id="node-modal" class="modal-overlay" aria-hidden="true">
            <div class="modal-panel">
              <div class="modal-row">
                <div class="modal-row-left">
                  <h4 id="node-modal-title" class="modal-title">Nodes</h4>
                  <span id="node-modal-count" class="label label-primary d-none"></span>
                </div>
                <div class="modal-row-right">
                  <input id="node-filter" type="text" class="form-control input-sm input-wide-220" placeholder="Filter (name, ip, device)">
                  <button id="node-copy" type="button" class="btn btn-xs btn-default" title="Copy visible nodes"><span class="glyphicon glyphicon-copy" aria-hidden="true"></span></button>
                  <button id="node-modal-close" type="button" class="btn btn-xs btn-default">Close</button>
                </div>
              </div>
              <div class="modal-table-wrap">
                <table id="node-modal-table" class="table table-condensed table-striped">
                  <thead>
                    <tr>
                      <th data-key="ip">IP / Net <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="n">Name <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="i">ID <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="d">Device <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="h">Host <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th data-key="m">Master <span class="glyphicon glyphicon-sort" aria-hidden="true"></span></th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="node-modal-tbody"><tr><td colspan="6" class="text-muted">Loading...</td></tr></tbody>
                </table>
              </div>
            </div>
          </div>